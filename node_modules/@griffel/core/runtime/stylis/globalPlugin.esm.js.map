{"version":3,"file":"globalPlugin.esm.js","sources":["../../../../../packages/core/src/runtime/stylis/globalPlugin.ts"],"sourcesContent":["import { RULESET, tokenize } from 'stylis';\nimport type { Middleware } from 'stylis';\n\nexport const globalPlugin: Middleware = element => {\n  switch (element.type) {\n    case RULESET:\n      if (typeof element.props === 'string') {\n        if (process.env.NODE_ENV !== 'production') {\n          throw new Error(\n            `\"element.props\" has type \"string\" (${JSON.stringify(\n              element.props,\n              null,\n              2,\n            )}), it's not expected. Please report a bug if it happens.`,\n          );\n        }\n\n        return;\n      }\n\n      element.props = element.props.map(value => {\n        // Avoids calling tokenize() on every string\n        if (value.indexOf(':global(') === -1) {\n          return value;\n        }\n\n        return tokenize(value)\n          .reduce<string[]>((acc, value, index, children) => {\n            if (value === '') {\n              return acc;\n            }\n\n            if (value === ':' && children[index + 1] === 'global') {\n              const selector =\n                // An inner part of \":global()\"\n                children[index + 2].slice(1, -1) +\n                // A separator between selectors i.e. \"body .class\"\n                ' ';\n\n              acc.unshift(selector);\n\n              children[index + 1] = '';\n              children[index + 2] = '';\n\n              return acc;\n            }\n\n            acc.push(value);\n            return acc;\n          }, [])\n          .join('');\n      });\n  }\n};\n"],"names":["globalPlugin","element","type","RULESET","props","process","env","NODE_ENV","Error","JSON","stringify","map","value","indexOf","tokenize","reduce","acc","index","children","selector","slice","unshift","push","join"],"mappings":";;AAGaA,MAAAA,YAAY,GAAeC,OAAO,IAAG;EAChD,QAAQA,OAAO,CAACC,IAAI;AAClB,IAAA,KAAKC,OAAO;AACV,MAAA,IAAI,OAAOF,OAAO,CAACG,KAAK,KAAK,QAAQ,EAAE;AACrC,QAAA,IAAIC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,YAAY,EAAE;AACzC,UAAA,MAAM,IAAIC,KAAK,CACb,CAAsCC,mCAAAA,EAAAA,IAAI,CAACC,SAAS,CAClDT,OAAO,CAACG,KAAK,EACb,IAAI,EACJ,CAAC,CACF,0DAA0D,CAC5D,CAAA;AACH,SAAA;AAEA,QAAA,OAAA;AACF,OAAA;MAEAH,OAAO,CAACG,KAAK,GAAGH,OAAO,CAACG,KAAK,CAACO,GAAG,CAACC,KAAK,IAAG;AACxC;QACA,IAAIA,KAAK,CAACC,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,EAAE;AACpC,UAAA,OAAOD,KAAK,CAAA;AACd,SAAA;AAEA,QAAA,OAAOE,QAAQ,CAACF,KAAK,CAAC,CACnBG,MAAM,CAAW,CAACC,GAAG,EAAEJ,KAAK,EAAEK,KAAK,EAAEC,QAAQ,KAAI;UAChD,IAAIN,KAAK,KAAK,EAAE,EAAE;AAChB,YAAA,OAAOI,GAAG,CAAA;AACZ,WAAA;AAEA,UAAA,IAAIJ,KAAK,KAAK,GAAG,IAAIM,QAAQ,CAACD,KAAK,GAAG,CAAC,CAAC,KAAK,QAAQ,EAAE;AACrD,YAAA,MAAME,QAAQ;AACZ;AACAD,YAAAA,QAAQ,CAACD,KAAK,GAAG,CAAC,CAAC,CAACG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAChC;YACA,GAAG,CAAA;AAELJ,YAAAA,GAAG,CAACK,OAAO,CAACF,QAAQ,CAAC,CAAA;AAErBD,YAAAA,QAAQ,CAACD,KAAK,GAAG,CAAC,CAAC,GAAG,EAAE,CAAA;AACxBC,YAAAA,QAAQ,CAACD,KAAK,GAAG,CAAC,CAAC,GAAG,EAAE,CAAA;AAExB,YAAA,OAAOD,GAAG,CAAA;AACZ,WAAA;AAEAA,UAAAA,GAAG,CAACM,IAAI,CAACV,KAAK,CAAC,CAAA;AACf,UAAA,OAAOI,GAAG,CAAA;AACZ,SAAC,EAAE,EAAE,CAAC,CACLO,IAAI,CAAC,EAAE,CAAC,CAAA;AACb,OAAC,CAAC,CAAA;AACN,GAAA;AACF;;;;"}